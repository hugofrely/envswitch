#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# EnvSwitch Pre-commit Hook
# Runs before each commit to ensure code quality

echo "ğŸ” Running pre-commit checks..."

# 1. Format code
echo "ğŸ“ Formatting code..."
make fmt || exit 1

# 2. Run go vet
echo "ğŸ” Running go vet..."
make vet || exit 1

# 3. Run tests
echo "ğŸ§ª Running tests..."
go test -short ./... || {
    echo "âŒ Tests failed. Please fix before committing."
    exit 1
}

# 4. Check build
echo "ğŸ—ï¸  Building..."
go build ./... || {
    echo "âŒ Build failed. Please fix before committing."
    exit 1
}

echo "âœ… All pre-commit checks passed!"
